<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Verificatore di Notizie AI</title>

<style>
*{margin:0;padding:0;box-sizing:border-box}
body{
    font-family:Segoe UI,Tahoma,Geneva,Verdana,sans-serif;
    background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);
    min-height:100vh;padding:20px
}
.container{
    max-width:900px;margin:auto;background:#fff;
    border-radius:20px;box-shadow:0 20px 60px rgba(0,0,0,.3);
    overflow:hidden
}
.header{
    background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);
    color:#fff;padding:30px;text-align:center
}
.header h1{font-size:2.4em;margin-bottom:10px}
.header p{opacity:.9;font-size:1.1em}
.input-section{padding:40px}
label{display:block;margin-bottom:10px;font-weight:600}
textarea{
    width:100%;min-height:120px;padding:15px;
    border:2px solid #e0e0e0;border-radius:10px;
    font-size:1em
}
textarea:focus{outline:none;border-color:#667eea}
.button-group{display:flex;gap:15px;margin-top:20px}
button{
    flex:1;padding:15px;border:none;border-radius:10px;
    font-size:1.1em;font-weight:600;cursor:pointer
}
.btn-verify{background:#667eea;color:#fff}
.btn-clear{background:#f0f0f0}
.loading{display:none;text-align:center;padding:40px}
.spinner{
    width:50px;height:50px;border:4px solid #eee;
    border-top:4px solid #667eea;border-radius:50%;
    animation:spin 1s linear infinite;margin:auto
}
@keyframes spin{to{transform:rotate(360deg)}}
.results{display:none;padding:40px;background:#f9f9f9}
.score-circle{
    width:150px;height:150px;border-radius:50%;
    display:flex;align-items:center;justify-content:center;
    font-size:3em;color:#fff;margin:auto
}
.section{
    background:#fff;padding:25px;margin-top:20px;
    border-radius:15px
}
.error{
    display:none;background:#f8d7da;color:#721c24;
    padding:15px;margin:20px;border-radius:10px
}
.disclaimer{
    margin:30px;padding:15px;background:#fff8db;
    border-left:5px solid #f1c40f;font-size:14px
}

/* ===== DONAZIONE FLOTTANTE ===== */
.donate-fab{
    position:fixed;right:18px;bottom:18px;
    width:44px;height:44px;border-radius:10px;
    background:#fff;box-shadow:0 10px 25px rgba(0,0,0,.25);
    display:flex;align-items:center;justify-content:center;
    cursor:pointer;z-index:9999
}
.donate-pop{
    position:fixed;right:18px;bottom:70px;
    width:280px;background:#fff;border-radius:14px;
    box-shadow:0 18px 40px rgba(0,0,0,.3);
    padding:12px;display:none;z-index:9999
}
.donate-pill{
    padding:8px 10px;border-radius:999px;
    background:#f2f2f2;border:1px solid #ddd;
    cursor:pointer;font-weight:700;font-size:13px
}
.donate-pill.active{background:#0070ba;color:#fff}
.donate-input{
    width:100%;padding:10px;border-radius:10px;
    border:1px solid #ddd;font-weight:700
}
.donate-btn{
    width:100%;padding:10px;margin-top:8px;
    border:none;border-radius:10px;
    background:#ffc439;font-weight:800;cursor:pointer
}
</style>
</head>

<body>

<div class="container">
<div class="header">
<h1>üîç Verificatore di Notizie AI</h1>
<p>Analisi intelligente della veridicit√† delle informazioni</p>
</div>

<div class="input-section">
<label>Inserisci notizia o URL</label>
<textarea id="newsInput"></textarea>
<div class="button-group">
<button class="btn-verify" onclick="verifyNews()">Verifica</button>
<button class="btn-clear" onclick="clearResults()">Cancella</button>
</div>
</div>

<div class="loading" id="loading">
<div class="spinner"></div>
<p>Analisi in corso...</p>
</div>

<div class="error" id="error"></div>

<div class="results" id="results">
<div class="score-circle" id="scoreCircle"><span id="scoreValue">0%</span></div>
<div class="section"><p id="explanation"></p></div>
</div>

<div class="disclaimer">
<strong>‚ö†Ô∏è Disclaimer:</strong>
Valutazione automatica basata su AI e statistiche delle fonti.
Non √® una verifica giornalistica o legale.
</div>
</div>

<!-- DONAZIONE -->
<div class="donate-fab"
     title="Supporta i costi AI (anche 0,10‚Ç¨)"
     onclick="toggleDonate()">‚òï</div>

<div class="donate-pop" id="donatePop">
<p><strong>Supporta i costi AI</strong></p>
<p style="font-size:13px">Anche 0,10‚Ç¨ aiutano</p>

<div style="display:flex;gap:6px;margin:6px 0">
<button class="donate-pill active" onclick="setAmt('0.10')">‚Ç¨0,10</button>
<button class="donate-pill" onclick="setAmt('0.50')">‚Ç¨0,50</button>
<button class="donate-pill" onclick="setAmt('1.00')">‚Ç¨1</button>
</div>

<input id="donateVal" class="donate-input" type="number" min="0.10" step="0.01" value="0.10">
<button class="donate-btn" onclick="goPayPal()">Dona con PayPal</button>
</div>

<script>
let donateAmount="0.10";

function toggleDonate(){
    const p=document.getElementById("donatePop");
    p.style.display=p.style.display==="block"?"none":"block";
}

function setAmt(v){
    donateAmount=v;
    document.getElementById("donateVal").value=v;
    document.querySelectorAll(".donate-pill").forEach(b=>b.classList.remove("active"));
    event.target.classList.add("active");
}

function goPayPal(){
    let raw=document.getElementById("donateVal").value.replace(",",".");
    let v=parseFloat(raw);
    if(isNaN(v)||v<0.10)v=0.10;
    donateAmount=v.toFixed(2);
    document.getElementById("donateVal").value=donateAmount;

    const url="https://www.paypal.com/donate/?business=YRKHL9B56MRTA&currency_code=EUR";
    window.open(url,"_blank","noopener,noreferrer");
}

async function verifyNews(){
    const t=document.getElementById("newsInput").value.trim();
    if(!t){showError("Inserisci una notizia");return;}
    document.getElementById("loading").style.display="block";
    try{
        const r=await fetch("/api/verify",{method:"POST",
        headers:{"Content-Type":"application/json"},
        body:JSON.stringify({input:t})});
        const d=await r.json();
        document.getElementById("scoreValue").textContent=d.analisi.veridicita+"%";
        document.getElementById("explanation").textContent=d.analisi.spiegazione;
        document.getElementById("results").style.display="block";
    }catch(e){showError(e.message)}
    document.getElementById("loading").style.display="none";
}

function showError(m){
    const e=document.getElementById("error");
    e.textContent=m;e.style.display="block";
}

function clearResults(){
    document.getElementById("newsInput").value="";
    document.getElementById("results").style.display="none";
}
</script>

</body>
</html>
